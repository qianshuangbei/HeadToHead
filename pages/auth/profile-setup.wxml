<!--pages/auth/profile-setup.wxml-->
<view class="container">
  <block wx:if="{{step === 'choose'}}">
    <view class="title">首次资料设置</view>
    <button type="primary" bindtap="chooseWeChatProfile">使用微信头像与昵称</button>
    <button bindtap="chooseCustomProfile">自定义头像与昵称</button>
    <view class="hint">可选择微信资料或自定义，后续可在“我的”里修改。</view>
  </block>

  <block wx:elif="{{step === 'editing'}}">
    <view class="field">
      <text class="label">头像</text>
      <image wx:if="{{avatarTempPath}}" src="{{avatarTempPath}}" class="avatar" mode="aspectFill" />
      <button size="mini" bindtap="selectAvatar">选择头像</button>
    </view>

    <view class="field">
      <text class="label">昵称</text>
      <input placeholder="输入昵称" value="{{nickname}}" bindinput="onNicknameInput" maxlength="16" />
    </view>

    <view class="field">
      <text class="label">持拍手</text>
      <radio-group bindchange="onHandednessChange">
        <label><radio value="left" checked="{{handedness==='left'}}" /> 左手</label>
        <label style="margin-left:16px"><radio value="right" checked="{{handedness==='right'}}" /> 右手</label>
      </radio-group>
    </view>

    <view class="field">
      <text class="label">主力球拍</text>
      <input placeholder="例如: Babolat Pure Drive" value="{{racket_primary}}" bindinput="onRacketInput" maxlength="40" />
    </view>

    <view class="field">
      <text class="label">个人标签 (最多20, 每个≤12字)</text>
      <input placeholder="输入标签后回车添加" value="{{tagInput}}" bindconfirm="onTagConfirm" bindinput="onTagInput" />
      <view class="tags">
        <block wx:for="{{tags}}" wx:key="index">
          <view class="tag">
            <text>{{item}}</text>
            <text class="remove" data-index="{{index}}" bindtap="removeTag">×</text>
          </view>
        </block>
      </view>
    </view>

    <view wx:if="{{error}}" class="error">{{error}}</view>

    <button type="primary" loading="{{saving}}" bindtap="saveProfile">完成并进入</button>
  </block>
</view>